<%- contentFor('HeaderCss') %>

<%-include("partials/title-meta", {"title": "Orders"})%>
<!-- gridjs css -->
<link rel="stylesheet" href="/assets/libs/gridjs/theme/mermaid.min.css">

<!-- datepicker css -->
<link rel="stylesheet" href="/assets/libs/flatpickr/flatpickr.min.css">
<%- contentFor('body') %>
<%-include("partials/page-title", {"pagetitle": "Ecommerce", "title": "Orders"})%>
<div class="row">
  <div class="col-12">
    <div class="card">
      <div class="card-header">
      </div>
      <div class="card-body">
        <table class="table mb-0" style="border-bottom: 1px solid black;">
          <thead class="table-dark">
            <tr>
              <th class="text-center">#</th>
              <th class="text-center">Order Number</th>
              <th class="text-center">Stripe Transcation ID</th>
              <th class="text-center">Total</th>
              <th class="text-center">Customer Name</th>
              <th class="text-center">Customer Address</th>
              <th class="text-center">Customer Contact</th>
              <th class="text-center">Cart Items</th>
            </tr>
          </thead>
          <tbody>
            <% if (orders.length === 0) { %>
              <tr>
                <td colspan="6" class="text-center">No orders found.</td>
              </tr>
            <% } else { %>
              <% orders.forEach((order, index) => { %>
                <tr>
                  <td class="text-center"><%= index + 1 %></td>
                  <td class="text-center"><%= order.orderNumber %></td>
                  <td class="text-center"><%= order.stripeid %></td>
                  <td class="text-center">KR<%= order.total %></td>
                  <td class="text-center"><%= order.billingAddress.firstName %> <%= order.billingAddress.lastName %></td>
                  <td class="text-center"><%= order.billingAddress.address %></td>
                  <td class="text-center"><%= order.billingAddress.contact %></td>
                  <td>
                    <table class="table text-center" style="box-shadow: 0px 0px 5px 2px rgba(0,0,0,0.1); border: 1px black solid;">
                      <thead class="table-dark">
                        <tr>
                          <th>#</th>
                          <th>Product Name</th>
                          <th>Price</th>
                          <th>Quantity</th>
                        </tr>
                      </thead>
                      <tbody>
                        <% order.cartItems.forEach((item, itemIndex) => { %>
                          <tr>
                            <td class="text-center"><%= itemIndex + 1 %></td>
                            <td class="text-center"><%= item.name %></td>
                            <td class="text-center">$<%= item.price %></td>
                            <td class="text-center"><%= item.quantity %></td>
                          </tr>
                        <% }); %>
                      </tbody>
                    </table>
                  </td>
                </tr>
              <% }); %>
            <% } %>
          </tbody>
        </table> 
      </div>
    </div>
  </div>
</div>
<!-- end row -->
<!-- end modal -->
<%- contentFor('FooterJs') %>
<!-- gridjs js -->
<script src="/assets/libs/gridjs/gridjs.umd.js"></script>

<!-- datepicker js -->
<script src="/assets/libs/flatpickr/flatpickr.min.js"></script>

<script src="/assets/js/pages/ecommerce-orders.init.js"></script>